(self.webpackChunkhpcdocs=self.webpackChunkhpcdocs||[]).push([[4627],{3905:function(e,t,r){"use strict";r.d(t,{Zo:function(){return l},kt:function(){return m}});var n=r(7294);function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var c=n.createContext({}),p=function(e){var t=n.useContext(c),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},l=function(e){var t=p(e.components);return n.createElement(c.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var r=e.components,o=e.mdxType,a=e.originalType,c=e.parentName,l=s(e,["components","mdxType","originalType","parentName"]),d=p(r),m=o,h=d["".concat(c,".").concat(m)]||d[m]||u[m]||a;return r?n.createElement(h,i(i({ref:t},l),{},{components:r})):n.createElement(h,i({ref:t},l))}));function m(e,t){var r=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=r.length,i=new Array(a);i[0]=d;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s.mdxType="string"==typeof e?e:o,i[1]=s;for(var p=2;p<a;p++)i[p]=r[p];return n.createElement.apply(null,i)}return n.createElement.apply(null,r)}d.displayName="MDXCreateElement"},2827:function(e,t,r){"use strict";r.r(t),r.d(t,{frontMatter:function(){return i},metadata:function(){return s},toc:function(){return c},default:function(){return l}});var n=r(2122),o=r(9756),a=(r(7294),r(3905)),i={slug:"scratch_disk"},s={unversionedId:"elja/scratch",id:"elja/scratch",isDocsHomePage:!1,title:"Scratch Disks",description:"Fast I/O (input/output) is facilitated with use of the local scratch disks available on the compute nodes.",source:"@site/docs/elja/03_scratch.md",sourceDirName:"elja",slug:"/elja/scratch_disk",permalink:"/docs/elja/scratch_disk",editUrl:"https://github.com/irhpc/irhpc.github.io/edit/main/docs/elja/03_scratch.md",version:"current",sidebarPosition:3,frontMatter:{slug:"scratch_disk"},sidebar:"tutorialSidebar",previous:{title:"Submitting Batch Jobs",permalink:"/docs/elja/submit_jobs"},next:{title:"Interactive Sessions",permalink:"/docs/elja/interactive_session"}},c=[{value:"Using /scratch/users/ with SBATCH",id:"using-scratchusers-with-sbatch",children:[]}],p={toc:c};function l(e){var t=e.components,i=(0,o.Z)(e,["components"]);return(0,a.kt)("wrapper",(0,n.Z)({},p,i,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"Fast ",(0,a.kt)("strong",{parentName:"p"},"I/O")," (input/output) is facilitated with use of the local scratch disks available on the compute nodes."),(0,a.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,a.kt)("div",{parentName:"div",className:"admonition-heading"},(0,a.kt)("h5",{parentName:"div"},(0,a.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,a.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,a.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,a.kt)("div",{parentName:"div",className:"admonition-content"},(0,a.kt)("p",{parentName:"div"},(0,a.kt)("strong",{parentName:"p"},"IMPORTANT:")," It is important to make efficient use of Elja and to not slow down the network traffic on the cluster. Hence, it is advisable to copy the data and input for your job over to the local scratch disk on the compute nodes (",(0,a.kt)("strong",{parentName:"p"},"/scratch/users/"),") and launch the program from there. If this step is omitted then the program will run remotely on the compute nodes but will constantly read/write from/to the submit directory on the ",(0,a.kt)("strong",{parentName:"p"},"NFS")," server. This creates a lot of network traffic and slows doen the use of Elja for everybody. It will also slow down the job itself."))),(0,a.kt)("h2",{id:"using-scratchusers-with-sbatch"},"Using /scratch/users/ with SBATCH"),(0,a.kt)("p",null,"The example here assumes the user is working with ",(0,a.kt)("strong",{parentName:"p"},"SBATCH")," scripts and in some work directory in the users home folder. For example"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"[..]$ pwd\n[..]$ /users/home/<uname>/myjob\n")),(0,a.kt)("p",null,"and your ",(0,a.kt)("strong",{parentName:"p"},"SBATCH")," submit script is in the same directory"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"[..]$ /users/home/<uname>/myjob/submit.sh\n")),(0,a.kt)("p",null,"Example of bash lines for ",(0,a.kt)("strong",{parentName:"p"},"/scratch/users/")," are provided below. The following lines should be added to your ",(0,a.kt)("strong",{parentName:"p"},"SBATCH")," script. An example ",(0,a.kt)("strong",{parentName:"p"},"SBATCH")," script is provided at the end."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},'[..]$ cat submit.sh\n..\n# Location of scratch directory on the compute nodes\nscratchlocation=/scratch/users\n\n# Create a user directory if it does not exist\nif [! -d $scratchlocation/$USER]; then\n    mkdir -p $scratchlocation/$USER\nfi\n\n# Create a temporary directory with a unique identifier associated with your jobid\ntdir=$(mktemp -d $scratchlocation/$USER/$SLURM_JOB_ID)\n\n# Go to the temporary directory\ncd $tdir\n\n# Exit if tdir does not exist\nif [! -d \u201c$tdir\u201d]; then\n    echo "Temporary scratch directory does not exist ..."\n    echo "Something is wrong, contact support."\n    exit\nfi\n\n# Copy the necessary input files to run your job\ncp $SLURM_SUBMIT_DIR/myinput $tdir/\n\n# If the program needs many input files you can add a separate line for each file.\n\n# If your job requires a directory of input files\n# cp -r $SLURM_SUBMIT_DIR/myinputdir $tdir/\n\n# Now the run the job from the temporary directory e.g.\nmyprogram myinput\n\n# After the job is completed make sure to copy the output to your submit directory.\ncp $tdir/myoutputfiles $SLURM_SUBMIT_DIR/\n\n# If the program produces many output files you can add a separate line for each file.\n# Please try to only copy the files that you need.\n\n# IMPORTANT. Delete the temporary directory and all of its content\nrm -rf $tdir\n\n')),(0,a.kt)("p",null,"An example ",(0,a.kt)("strong",{parentName:"p"},"SBATCH")," script for a typical Python job is provided ",(0,a.kt)("a",{target:"_blank",href:r(2163).Z},"here"),". Similar commands can be used when the user is in an ",(0,a.kt)("a",{parentName:"p",href:"interactive_session"},"interactive session"),"."))}l.isMDXComponent=!0},2163:function(e,t,r){"use strict";t.Z=r.p+"assets/files/py_submit-174aa2794e34ada476072a981dbb8c43.txt"}}]);